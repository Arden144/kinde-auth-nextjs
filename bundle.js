import e,{useState as r,useCallback as t,useEffect as i,createContext as s,useContext as o}from"react";const a={user:null,isAuthenticated:!1,isLoading:!0,checkSession:null},n=()=>{throw new Error("Oops! Seems like you forgot to wrap your app in <KindeProvider>.")},c=s({...a,user:n,isLoading:n,isAuthenticated:n,checkSession:n}),u=()=>o(c);var d=({children:s,initialUser:o})=>{const[n,u]=r({...a,user:o,isLoading:!o,isAuthenticated:!!o}),d="/api/auth/me",h=t((async()=>{try{const e=await(async e=>{let r;try{r=await fetch(e)}catch{throw new RequestError(0)}if(r.ok)return r.json();r.status})(d);u((r=>({...r,user:e,error:void 0})))}catch(e){u((r=>({...r,error:e})))}}),[d]);i((async()=>{n.user||(await h(),u((e=>({...e,isLoading:!1}))))}),[n.user]);const{user:l,error:w,isLoading:g,isAuthenticated:p}=n;return e.createElement(c.Provider,{value:{user:l,error:w,isLoading:g,isAuthenticated:p}},s)};export{c as AuthContext,d as KindeProvider,u as useAuth};
